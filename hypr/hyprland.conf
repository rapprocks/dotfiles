################
### MONITORS ###
################

#monitor=,preferred,auto,auto
#monitor=DP-1,2560x1440@119,0x0,1

###################
### MY PROGRAMS ###
###################

# Set programs that you use
$terminal = alacritty
$fileManager = thunar
$menu = fuzzel

#################
### AUTOSTART ###
#################

exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP HYPRLAND_INSTANCE_SIGNATURE
exec-once = hypridle
exec-once = hyprctl setcursor Adwaita 22
#exec-once = systemctl --user start kanshi.service
exec-once = kanshi
exec-once = waybar

exec = swayosd-server

#############################
### ENVIRONMENT VARIABLES ###
#############################

#env=BROWSER,zen-browser

env = NIXOS_OZONE_WL,1

env = XCURSOR_THEME,Adwaita
env = XCURSOR_SIZE,22
env = HYPRCURSOR_THEME,Adwaita
env = HYPRCURSOR_SIZE,22

env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = XDG_SESSION_DESKTOP,Hyprland

#####################
### LOOK AND FEEL ###
#####################

##########################################################

general {
  border_size=1
	col.active_border=rgb(ebbcba)
  col.inactive_border=rgb(45475a)
  gaps_in=0
  gaps_out=0
  layout=dwindle
}

debug {
	disable_scale_checks=true
	disable_logs = false
	#overlay=true
}

decoration {
  rounding = 0
  rounding_power = 0

  shadow {
      enabled = false
    }

  blur {
      enabled = false
    }

  
}

animations {
 enabled=true
  bezier=easeOutQuint,0.23,1,0.32,1
  bezier=easeInOutCubic,0.65,0.05,0.36,1
  bezier=linear,0,0,1,1
  bezier=almostLinear,0.5,0.5,0.75,1.0
  bezier=quick,0.15,0,0.1,1
  animation=global, 1, 10, default
  animation=border, 1, 5.39, easeOutQuint
  animation=windows, 1, 4.79, easeOutQuint
  animation=windowsIn, 1, 4.1, easeOutQuint, popin 87%
  animation=windowsOut, 1, 1.49, linear, popin 87%
  animation=fadeIn, 1, 1.73, almostLinear
  animation=fadeOut, 1, 1.46, almostLinear
  animation=fade, 1, 3.03, quick
  animation=layers, 1, 3.81, easeOutQuint
  animation=layersIn, 1, 4, easeOutQuint, fade
  animation=layersOut, 1, 1.5, linear, fade
  animation=fadeLayersIn, 1, 1.79, almostLinear
  animation=fadeLayersOut, 1, 1.39, almostLinear
  animation=workspaces, 1, 2, default
}

cursor {
  no_hardware_cursors = 1
}

master {
  mfact=0.5
}

misc {
  disable_hyprland_logo=true
  focus_on_activate=true
  force_default_wallpaper=1
  allow_session_lock_restore=1
}

xwayland {
  force_zero_scaling=true
}

###########################################################

dwindle {
    pseudotile = true # Master switch for pseudotiling. Enabling is bound to mainMod + P in the keybinds section below
    preserve_split = true # You probably want this
    force_split = 2
}

#############
### INPUT ###
#############

input {
  touchpad {
    clickfinger_behavior=true
    disable_while_typing=true
    drag_lock=0
    natural_scroll=true
  }
  accel_profile=flat
  #sensitivity=1.0
  kb_layout=se
  kb_options=caps:escape,altwin:swap_lalt_lwin
  kb_variant=nodeadkeys
  repeat_delay=225
  repeat_rate=50
}

device {
  name=elan0763:00-04f3:31ec-touchpad
  sensitivity=1.0
}

device {
  name=syna30d9:00-06cb:cea4-touchpad
  sensitivity=-1.0
}

device {
	name=syna310d:00-06cb:cea4-touchpad
	sensitivity=1.0
}

device {
	name=logitech-wireless-mouse-mx-master-3-1
	sensitivity=0.5
}

device {
	name=logitech-usb-receiver-keyboard-1
	sensitivity=0.5
}

###################
### KEYBINDINGS ###
###################

$mainMod = SUPER # Sets "Windows" key as main modifier

bind = $mainMod, RETURN, exec, $terminal
bind = $mainMod, Q, killactive,
bind = $mainMod SHIFT, E, exit,
bind = $mainMod, T, exec, alacritty -e yazi
bind = $mainMod SHIFT, SPACE, togglefloating,
bind = $mainMod, D, exec, $menu
bind = $mainMod SHIFT, R, exec, $menu2
bind = $mainMod, F, fullscreen
bind = $mainMod, P, pseudo, # dwindle
bind = $mainMod, J, togglesplit, # dwindle
bind = $mainMod SHIFT, escape, exec, hyprlock
bind = $mainMod SHIFT, r, exec, screenrec
bind = $mainMod SHIFT, p, exec, hyprshot -z -m region -o $HOME/Pictures/screenshots/
bind = $mainMod SHIFT, C, exec, pkill kanshi; kanshi & hyprctl reload && notify-send "Reloaded hyprland config and kanshi"

bind = $mainMod, o, exec, bash -i ~/.dotfiles/sh/toggle_waybar.sh

# Move focus with mainMod + arrow keys
bind = $mainMod, left, movefocus, l
bind = $mainMod, right, movefocus, r
bind = $mainMod, up, movefocus, u
bind = $mainMod, down, movefocus, d

# Switch workspaces with mainMod + [0-9]
bind = $mainMod, 1, workspace, 1
bind = $mainMod, 2, workspace, 2
bind = $mainMod, 3, workspace, 3
bind = $mainMod, 4, workspace, 4
bind = $mainMod, 5, workspace, 5
bind = $mainMod, 6, workspace, 6
bind = $mainMod, 7, workspace, 7
bind = $mainMod, 8, workspace, 8
bind = $mainMod, 9, workspace, 9
bind = $mainMod, 0, workspace, 10

# Move active window to a workspace with mainMod + SHIFT + [0-9]
bind = $mainMod SHIFT, 1, movetoworkspace, 1
bind = $mainMod SHIFT, 2, movetoworkspace, 2
bind = $mainMod SHIFT, 3, movetoworkspace, 3
bind = $mainMod SHIFT, 4, movetoworkspace, 4
bind = $mainMod SHIFT, 5, movetoworkspace, 5
bind = $mainMod SHIFT, 6, movetoworkspace, 6
bind = $mainMod SHIFT, 7, movetoworkspace, 7
bind = $mainMod SHIFT, 8, movetoworkspace, 8
bind = $mainMod SHIFT, 9, movetoworkspace, 9
bind = $mainMod SHIFT, 0, movetoworkspace, 10

# Example special workspace (scratchpad)
bind = $mainMod, minus, togglespecialworkspace, magic
bind = $mainMod SHIFT, minus, movetoworkspace, special:magic

# Scroll through existing workspaces with mainMod + scroll
bind = $mainMod, mouse_down, workspace, e+1
bind = $mainMod, mouse_up, workspace, e-1

# Move/resize windows with mainMod + LMB/RMB and dragging
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

# Laptop multimedia keys for volume and LCD brightness

bindel = ,XF86AudioMicMute, exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
bindel = ,XF86MonBrightnessUp, exec, brightnessctl s 10%+
bindel = ,XF86MonBrightnessDown, exec, brightnessctl s 10%-

$osdclient = swayosd-client --monitor "$(hyprctl monitors -j | jq -r '.[] | select(.focused == true).name')"

$swayosd = swayosd-client

bindeld = ,XF86AudioRaiseVolume, Volume up, exec, $osdclient --output-volume raise
bindeld = ,XF86AudioLowerVolume, Volume down, exec, $osdclient --output-volume lower
bindeld = ,XF86AudioMute, Mute, exec, $osdclient --output-volume mute-toggle

##############################
##### CLAMSHELL MODE #########
##############################

## Lid is opened
#bindl=,switch:off:Lid Switch,exec,shikanectl reload open
#bindl=,switch:off:Lid Switch,exec,notify-send "lid open" & shikanectl reload

## Lid is closed
#bindl=,switch:on:Lid Switch,exec,shikanectl switch clamshell close
#bindl=,switch:on:Lid Switch,exec,notify-send "lid closed" & shikanectl switch Clamshell

# Requires playerctl
bindl = , XF86AudioNext, exec, playerctl next
bindl = , XF86AudioPause, exec, playerctl play-pause
bindl = , XF86AudioPlay, exec, playerctl play-pause
bindl = , XF86AudioPrev, exec, playerctl previous

##############################
### WINDOWS AND WORKSPACES ###
##############################

# Ignore maximize requests from apps. You'll probably like this.
windowrulev2 = suppressevent maximize, class:.*
#windowrulev2 = noborder, onworkspace:w[t1] # Removes border if there's only one window / client

# Fix some dragging issues with XWayland
windowrulev2 = nofocus,class:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0

# Floating windows
windowrule = float, tag:floating-window
windowrule = center, tag:floating-window
windowrule = size 875 600, tag:floating-window

windowrule = tag +floating-window, class:(org.omarchy.bluetuith|org.omarchy.impala|org.omarchy.wiremix|org.omarchy.btop|org.omarchy.terminal|org.omarchy.bash|org.gnome.NautilusPreviewer|org.gnome.Evince|com.gabm.satty|Omarchy|About|TUI.float|imv|mpv)
windowrule = tag +floating-window, class:(xdg-desktop-portal-gtk|sublime_text|DesktopEditors|org.gnome.Nautilus), title:^(Open.*Files?|Open [F|f]older.*|Save.*Files?|Save.*As|Save|All Files|.*wants to [open|save].*|[C|c]hoose.*)
windowrule = float, class:org.gnome.Calculator

# No transparency on media windows
windowrule = opacity 1 1, class:^(zoom|vlc|mpv|org.kde.kdenlive|com.obsproject.Studio|com.github.PintaProject.Pinta|imv|org.gnome.NautilusPreviewer)$

# Popped window rounding
windowrule = rounding 8, tag:pop

# Prevent idle while open
windowrule = idleinhibit always, tag:noidle
